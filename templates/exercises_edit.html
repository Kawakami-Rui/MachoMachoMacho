{% extends 'base.html' %}

{% block title %}筋トレ種目一覧{% endblock %}

{% block head %}
{{ super() }}
<!-- 編集用のcssファイルを読み込み -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/exercises_edit.css') }}">
{% endblock %}

{% block content %}
<!-- ページのタイトルと編集モード切り替えボタン -->
<h2 class="page-title">
    <span>筋トレ種目一覧</span>
    <span><button id="edit-mode-toggle">編集</button></span>
</h2>

<!-- 種目リストのヘッダー行 -->
<div class="exercise-header">
    <div class="col part">主な筋肉部位</div>
    <div class="col name">種目名</div>
    <div class="col detail">詳細な筋肉部位</div>
    <div class="col operation" id="operation-header" style="display: none;"></div>
</div>

<!-- カテゴリごとに種目をグループ化して表示 -->
{% for category, exercises in grouped_exercises.items() %}
    <div class="main-group-section">
        <div class="group-title">{{ category }}</div>
        <div class="exercise-list">
            <!-- 種目が存在する場合、リストとして表示 -->
            {% if exercises %}
                {% set sorted_exercises = exercises | sort(attribute='order') %}
                {% for exercise in sorted_exercises %}
                    <div class="exercise-row" data-id="{{ exercise.id }}">
                        <div class="col part"></div>
                        <div class="col name">{{ exercise.name }}</div>
                        <div class="col detail">{{ exercise.detail }}</div>
                        <div class="col operation operation-cell" style="display: none;">
                            <button class="move-up button">↑</button>
                            <button class="move-down button">↓</button>
                            <button class="delete button">削除</button>
                        </div>
                    </div>
                {% endfor %}
            <!-- 種目が存在しない場合、登録なしと表示 -->
            {% else %}
                <div class="no-entry">
                    <div class="col part"></div>
                    <div class="col name">（登録なし）</div>
                    <div class="col detail"></div>
                    <div class="col operation"></div>
                </div>
            {% endif %}
            <!-- 種目を追加するボタン（編集モード時に表示） -->
            <div class="add-button-wrapper" style="display: none;">
                <button class="add-button-style" data-category="{{ category }}">＋追加</button>
            </div>
        </div>
    </div>
{% endfor %}

<!-- トップメニューへの戻るリンク -->
<p><a href="{{ url_for('index') }}">← トップメニューへ戻る</a></p>

<!-- 編集用のJavaScriptファイルを読み込み -->
<script src="{{ url_for('static', filename='js/exercises_edit.js') }}"></script>
{% endblock %}